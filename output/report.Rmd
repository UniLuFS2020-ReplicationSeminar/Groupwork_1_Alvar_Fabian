---
title: "report"
output:
  html_document: default
  word_document: default
date: '2024-03-28'
---


# Class Exercise 1


## Data Import

```{r, echo=FALSE}
library(readxl)
data <- read_excel("data/data.xlsx")
View(data)
```
data source: https://www.europeansocialsurvey.org/data-portal


## Data Preparation

```{r, echo=FALSE}
# Extract relevant columns and show the first 10 observations of the new data set
data_prep <- data[c("stfeco", "trstplt")]
head(data_prep, 10)
```


```{r, echo=FALSE}
# Rename columns
colnames(data_prep) <- c("econ_satisfaction", "trust_politicians")

# Mapping values 77, 88 and 99 to NA
data_prep[data_prep == 77] <- NA
data_prep[data_prep == 88] <- NA
data_prep[data_prep == 99] <- NA

# Delete missing values (NA)
data_prep <- na.omit(data_prep)

# View the data
View(data_prep)

# Save the data to dedicated folder
write.csv(data, "data/data_prep.csv")
```


## Research Question.

Do people who are satisfied with present state of economy in country have more trust in politicians?


## Empirical Hypothesis

People that are more satisfied with present state of economy in country might have more trust in their politicians. This hypothesis suggests that there is a positive correlation between economic satisfaction and trust in politicians. It implies that individuals who perceive the economy as doing well are more inclined to trust political leaders, as they may attribute economic prosperity to the policies and actions of those leaders.


## Hypothesis Testing

### 1. Descriptive Statistics

```{r, echo=FALSE}
# Descriptive statistics for econ_satisfaction
summary(data_prep$econ_satisfaction)

# Descriptive statistics for trust_politicians
summary(data_prep$trust_politicians)
```
The descriptive statistics suggest than economic satisfaction is generally rated better than the trust in politicians (higher mean and median values).


### 2. Linear Regression

```{r,echo=FALSE}
model <- lm(trust_politicians ~ econ_satisfaction, data = data_prep)

# Summary of the model
summary(model)
```
According to the linear regression the relationship is statistically significant on the 1% CI and as expected positive.

```{r, echo=FALSE}
library(ggplot2)

# Generate predictions
predictions <- predict(model, newdata = data_prep)

# Create a data frame with original data and predictions
prediction_df <- data.frame(data_prep$econ_satisfaction, data_prep$trust_politicians, predictions)
colnames(prediction_df) <- c("Economic_Satisfaction", "Trust_in_Politicians", "Predicted_Trust")

# Display the first few rows of the prediction data frame
head(prediction_df)

# Calculate the differences between Trust_in_Politicians and Predicted_Trust
prediction_df$Difference <- prediction_df$Trust_in_Politicians - prediction_df$Predicted_Trust

# Calculate the average difference
average_difference <- mean(prediction_df$Difference)
```
The average difference between actual and predicted values seems very small.


### 3. Pearson Correlation

```{r, echo=FALSE}
correlation_pearson <- cor(data_prep$econ_satisfaction, data_prep$trust_politicians, method = "pearson")
print(correlation_pearson)
```


## Plots

### Histograms

```{r, echo=FALSE}
# Plotting a histogram for both variables
par(mfrow=c(1,2)) # Set up a 1x2 grid for plotting

# a. Histogram for econ_satisfaction
hist(data_prep$econ_satisfaction, main="Economic Satisfaction", xlab="Satisfaction", ylab="Frequency", col="skyblue")

# Save the histogram plot to "figures"-folder
ggsave("figures/histogram1.png")

# b. Histogram for trust_politicians
hist(data_prep$trust_politicians, main="Trust in Politicians", xlab="Trust Level", ylab="Frequency", col="lightgreen")

# Save the histogram to "figures"-folder
ggsave("figures/histogram2.png")
```
There are quite a lot of 0 or 1 values at the trust values (meaning no or almost no trust) and very few above 8. For economic satisfaction the values 5-8 were selected the most.


### Boxplots

```{r, echo=FALSE}
# Boxplot 1
ggplot(data_prep, aes(x = factor(econ_satisfaction), y = trust_politicians)) +
  geom_boxplot() +
  labs(x = "Economic Satisfaction", y = "Trust in Politicians") +
  ggtitle("Boxplot of Trust in Politicians by Economic Satisfaction")

# Save the boxplot to "figures"-folder
ggsave("figures/boxplot1.png")

# Boxplot 2
ggplot(data_prep, aes(x = factor(trust_politicians), y = econ_satisfaction)) +
  geom_boxplot() +
  labs(x = "Trust in Politicians", y = "Economic Satisfaction") +
  ggtitle("Boxplot of Economic Satisfaction by  Trust in Politicians")

# Save the boxplot to "figures"-folder
ggsave("figures/boxplot2.png")
```
The two box plots illustrate the positive relationship between the two variables. People rating the economic situation as unsatisfying have very low trust in their politicians. The trustness increases whith increasing economic satisfaction (until economic situation = 9). For those who are very satisfied with economic situation (10) the trust is bit lower (significance unclear). When we change perspective and consideder the trust in politicians as X variable a similar pattern is observable: the higher the trust in politicians the higher their economic satisfaction.


### Heatmap

```{r, echo=FALSE}
ggplot(data_prep, aes(x = econ_satisfaction, y = trust_politicians)) +
  geom_bin2d() +
  scale_fill_gradient(low = "white", high = "blue") +
  labs(x = "Economic Satisfaction", y = "Trust in Politicians") +
  ggtitle("Heatmap of Economic Satisfaction vs. Trust in Politicians")

# Save the heatmap to "figures"-folder
ggsave("figures/heatmap.png")
```
The heatmap shows in which combinations between the two variables the most observations can be counted. Many participants chose for both variables 0 or 5 (which could be bias due to selecting a "popular number"). Apart from that the observations we made before are confirmed: higher values for economic satisfaction, many 5 and 7 selections for economic satisfaction, positive relationsship.


### Plot the Linear Model

```{r, echo=FALSE}
# Plot the linear model
ggplot(data_prep, aes(x = econ_satisfaction, y = trust_politicians)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Linear Regression Model",
       x = "Economic Satisfaction",
       y = "Trust in Politicians")

# Save the linear model plot to "figures"-folder
ggsave("figures/linear_regression.png")
```
The linear regression model also shows the positive relationship between the variables.


## Conclusion
Based on these findings, it can be concluded that there is indeed a positive relationship between economic satisfaction and trust in politicians. Individuals who perceive the economy as performing well are more likely to express trust in political leaders. This underscores the importance of economic factors in shaping public perceptions of political leadership and governance. However, it's essential to recognize that causality cannot be inferred from this analysis alone (omitted variables, reversed causality), and further research would be needed to explore the underlying mechanisms driving this relationship. 


