---
title: "report"
output: html_document
date: "2024-03-28"
---


# Class Exercise 1


## Data Import

```{r}
library(readxl)
data <- data # we have already imported the data file in R file data_import
View(data)
```
data source: https://www.europeansocialsurvey.org/data-portal


## Data Preparation

Extract relevant columns and show the first 10 observations of the new data set

```{r}
data_prep <- data[c("stfeco", "trstplt")]
head(data_prep, 10)
```


```{r}
# Rename columns
colnames(data_prep) <- c("econ_satisfaction", "trust_politicians")

# Mapping values 77, 88 and 99 to NA
data_prep[data_prep == 77] <- NA
data_prep[data_prep == 88] <- NA
data_prep[data_prep == 99] <- NA

# Delete missing values (NA)
data_prep <- na.omit(data_prep)

# View the data
View(data_prep)

# Save the data to dedicated folder
write.csv(data, "data_prep/data_prep.csv")
```


## Research Question.

Do people who are satisfied with present state of economy in country have more trust in politicians?


## Empirical Hypothesis

People that are more satisfied with present state of economy in country might have more trust in their politicians


## Hypothesis Testing

### 1. Descriptive Statistics

```{r}
# Descriptive statistics for stfeco
summary(data_prep$econ_satisfaction)

# Descriptive statistics for trstplt
summary(data_prep$trust_politicians)
```


### 2. Linear Regression

```{r}
model <- lm(trust_politicians ~ econ_satisfaction, data = data_prep)

# Summary of the model
summary(model)

# Generate predictions
predictions <- predict(model, newdata = data_prep)

# Create a data frame with original data and predictions
prediction_df <- data.frame(data_prep$econ_satisfaction, data_prep$trust_politicians, predictions)
colnames(prediction_df) <- c("Economic_Satisfaction", "Trust_in_Politicians", "Predicted_Trust")

# Display the first few rows of the prediction data frame
head(prediction_df)

# Plot observed vs. predicted values
ggplot(prediction_df, aes(x = Trust_in_Politicians, y = Predicted_Trust)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(title = "Observed vs. Predicted Values",
       x = "Observed Trust in Politicians",
       y = "Predicted Trust in Politicians")
```


### 3. Pearson Correlation

```{r}
correlation_pearson <- cor(data_prep$econ_satisfaction, data_prep$trust_politicians, method = "pearson")
print(correlation_pearson)
```


## Plots

### Histograms

```{r}
# Plotting a histogram for both variables
par(mfrow=c(1,2)) # Set up a 1x2 grid for plotting

# a. Histogram for econ_satisfaction
hist(data_prep$econ_satisfaction, main="Economic Satisfaction", xlab="Satisfaction", ylab="Frequency", col="skyblue")

# Save the histogram plot to "figures"-folder
ggsave("figures/histogram1.png")

# b. Histogram for trust_politicians
hist(data_prep$trust_politicians, main="Trust in Politicians", xlab="Trust Level", ylab="Frequency", col="lightgreen")

# Save the histogram to "figures"-folder
ggsave("figures/histogram2.png")
```


### Boxplots

```{r}
# Boxplot 1
ggplot(data_prep, aes(x = factor(econ_satisfaction), y = trust_politicians)) +
  geom_boxplot() +
  labs(x = "Economic Satisfaction", y = "Trust in Politicians") +
  ggtitle("Boxplot of Trust in Politicians by Economic Satisfaction")

# Save the boxplot to "figures"-folder
ggsave("figures/boxplot1.png")

# Boxplot 2
ggplot(data_prep, aes(x = factor(trust_politicians), y = econ_satisfaction)) +
  geom_boxplot() +
  labs(x = "Trust in Politicians", y = "Economic Satisfaction") +
  ggtitle("Boxplot of Economic Satisfaction by  Trust in Politicians")

# Save the boxplot to "figures"-folder
ggsave("figures/boxplot2.png")
```


### Heatmap

```{r}
ggplot(data_prep, aes(x = econ_satisfaction, y = trust_politicians)) +
  geom_bin2d() +
  scale_fill_gradient(low = "white", high = "blue") +
  labs(x = "Economic Satisfaction", y = "Trust in Politicians") +
  ggtitle("Heatmap of Economic Satisfaction vs. Trust in Politicians")

# Save the heatmap to "figures"-folder
ggsave("figures/heatmap.png")
```


### Plot the Linear Model

```{r}
# Plot the linear model
ggplot(data_prep, aes(x = econ_satisfaction, y = trust_politicians)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Linear Regression Model",
       x = "Economic Satisfaction",
       y = "Trust in Politicians")

# Save the linear model plot to "figures"-folder
ggsave("figures/linear_regression.png")
```



  




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
